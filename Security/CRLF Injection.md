Что такое CRLF-инъекция?

При CRLF-инъекции злоумышленник вставляет символы возврата каретки и ввода строки в пользовательский ввод, чтобы обмануть сервер, веб-приложение или пользователя, заставив его думать, что один объект завершился, а другой начался. Таким образом, CRLF-последовательности не являются вредоносными символами сами по себе, но могут быть использованы злоумышленниками для разделения HTTP-ответов (HTTP Response Splitting).

Тоесть с помощью ручного указывания каретки можно передать в запрос свои параметры с исплняющим кодом который потом отработает в приложении

## Примеры

В зависимости от того, как разработано приложение, это может быть незначительной проблемой или довольно серьезным недостатком безопасности. Давайте рассмотрим последний, поскольку это, в конце концов, пост, связанный с безопасностью.

Предположим, что файл используется в какой-то момент для чтения/записи данных в журнал какого-либо рода. Если злоумышленнику удалось разместить CRLF, он может внедрить в файл какой-то программный метод чтения. Это может привести к записи содержимого на экран при следующей попытке использования этого файла.

Другим примером являются атаки «разделения ответа», когда CRLF внедряются в приложение и включаются в ответ. Дополнительные CRLF интерпретируются прокси, кэшами и, возможно, браузерами как конец пакета, вызывая хаос.

## Как предотвратить CRLF/HTTP-инъекции заголовков в веб-приложениях

  

Лучший метод предотвращения – это не использовать ввод данных пользователем непосредственно в заголовок ответа. Если это невозможно, вы всегда должны использовать функцию для кодирования специальных символов CRLF. Еще одна хорошая практика безопасности – это обновление языка программирования до версии, которая не позволяет делать инъекции CR и LF внутри функций, которые устанавливают HTTP-заголовки.

## Последствия CRLF-инъекции

Последствия CRLF-инъекции варьируются и могут включать в себя все последствия использования [[XSS]] и раскрытия конфиденциальной информации. Таким способом можно деактивировать некоторые ограничения системы безопасности, такие как фильтры [[XSS]] и Same Origin Policy в браузерах жертвы, делая их уязвимыми к вредоносным атакам.