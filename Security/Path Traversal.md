Атака обхода пути (также известная как обход каталога) направлена ​​на доступ к файлам и каталогам, которые хранятся за пределами корневой папки веб-сайта. Манипулируя переменными, которые ссылаются на файлы с помощью последовательностей «точка-точка-слэш (../)» и их вариаций или используя абсолютные пути к файлам, можно получить доступ к произвольным файлам и каталогам, хранящимся в файловой системе, включая исходный код приложения или конфигурацию и критические системные файлы. Следует отметить, что доступ к файлам ограничен операционным контролем доступа системы (например, в случае заблокированных или используемых файлов в операционной системе Microsoft Windows).

Эта атака также известна как «точка-точка-слэш», «обход каталога», «подъём по каталогу» и «возврат».

Обычно точкой уязвимости становятся ассеты. Также это касается подключаемых скриптов через include. Также если папки и файлысервера имеют много прав аля 777

Если ассеты криво лежат, то через путь можно дойти до файлов системы и либо достать чувствительную информацию.

---

- Хранилище держать отдельно от веб сервера где крутится система и приложение
- Проверяь запрос к ассету через БД если пути нет в БД просто отдаем 404
- Ограничить права чтения и папок

- Работать без участия пользователя при использовании вызовов файловой системы (?)

- Используйте индексы, а не фактические части имен файлов при создании шаблонов или использовании языковых файлов (например, значение 5 из пользовательского ввода = чехословацкий, а не ожидайте, что пользователь вернет «чехословацкий»)
Отдавать запрос аля asset/aysd7f8sdaf8.jpeg по индексу брать файл из asset/images/logo.jpeg и возвращать его содержимое. Делается через БД и проверку путей

- Убедитесь, что пользователь не может предоставить все части пути — заключите его в код вашего пути (?)

- Валидировать параметры с путями если такие принимаются

- Используйте chrooted jails и политики доступа к коду, чтобы ограничить, где файлы могут быть получены или сохранены (?)

- Если для файловых операций необходимо использовать пользовательский ввод, нормализуйте ввод перед использованием в API файлового ввода-вывода, например [normalize()](http://docs.oracle.com/javase/7/docs/api/java/net/URI.html#normalize()) . (нормализация пути, удаляем ./../ из пути)

---

**Что такое Path Traversal?**

Path Traversal (также известный как Directory Traversal или файловая трансверсия) в PHP — это уязвимость безопасности, при которой злоумышленник может попытаться получить доступ к файлам или директориям за пределами предназначенной области. Это может произойти, если приложение неправильно обрабатывает пользовательский ввод в пути файлов.

Например, если веб-приложение позволяет пользователю вводить путь к файлу или директории и не достаточно проверяет и фильтрует этот ввод, злоумышленник может использовать специально сформированные строки для «перехода» за пределы заданной директории и, таким образом, получить доступ к конфиденциальным файлам на сервере.

В приведенном выше коде, если параметр file передается через URL, злоумышленник может использовать символы «../» для перехода на уровень выше и получения доступа к файлам за пределами заданной директории.

Для предотвращения атак Path Traversal важно правильно обрабатывать и валидировать пользовательский ввод, особенно при работе с файловой системой. Рекомендуется использовать абсолютные пути и проверять, что запрошенные ресурсы находятся в пределах ожидаемой области файловой структуры. Также полезно ограничивать права доступа к файлам и директориям на сервере.